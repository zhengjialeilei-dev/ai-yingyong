<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é­”æ³•è¯æ°´æµ“åº¦æ¨¡æ‹Ÿå™¨ - ç™¾åˆ†æ•°çš„è®¤è¯†</title>
    <!-- å¼•å…¥ React å’Œ ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- å¼•å…¥ Babel ç”¨äºè§£æ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- å¼•å…¥ Tailwind CSS ç”¨äºå¿«é€Ÿå¸ƒå±€ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* è‡ªå®šä¹‰å­—ä½“ä¸å…¨å±€æ ·å¼ */
        @import url('https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=Noto+Sans+SC:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f0f4f8;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }

        h1, h2, .fun-font {
            font-family: 'ZCOOL KuaiLe', cursive;
        }

        /* çƒ§æ¯æ ·å¼ */
        .beaker-container {
            position: relative;
            width: 180px;
            height: 300px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.2);
            border: 4px solid #4a5568;
            border-top: none;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), inset 0 0 20px rgba(255, 255, 255, 0.5);
            overflow: hidden; /* ä¿æŒæ¶²ä½“åœ¨çƒ§æ¯å†… */
            z-index: 10;
        }

        /* åˆ»åº¦çº¿ */
        .measurement-lines {
            position: absolute;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }
        .line {
            position: absolute;
            right: 0;
            width: 15px;
            height: 2px;
            background: #718096;
        }
        .line-label {
            position: absolute;
            right: 20px;
            font-size: 10px;
            color: #718096;
            transform: translateY(-50%);
        }

        /* æ¶²ä½“æ ·å¼ */
        .liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            transition: height 0.5s ease-out, background-color 0.3s ease;
            z-index: 5;
        }

        /* æ¶²ä½“è¡¨é¢çš„æ³¢æµªåŠ¨ç”» */
        .wave {
            position: absolute;
            top: -10px;
            left: 0;
            width: 200%;
            height: 20px;
            background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 1200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none"><path d="M321.39 56.44c58-10.79 114.16-30.13 172-41.86 82.39-16.72 168.19-17.73 250.45-.39C823.78 31 906.67 72 985.66 92.83c70.05 18.48 146.53 26.09 214.34 3V0H0v27.35a600.21 600.21 0 00321.39 29.09z" fill="rgba(255,255,255,0.3)"/></svg>');
            background-size: 50% 100%;
            animation: wave-animation 3s linear infinite;
            opacity: 0.6;
        }

        @keyframes wave-animation {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* é­”æ³•ç²’å­ï¼ˆæ°”æ³¡ï¼‰ */
        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 200, 0.8);
            box-shadow: 0 0 5px gold;
            bottom: -10px;
            animation: floatUp 4s infinite linear;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateY(-300px) scale(1.2); opacity: 0; }
        }

        /* æ»‘å—è‡ªå®šä¹‰æ ·å¼ */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #ffffff;
            border: 2px solid #667eea;
            cursor: pointer;
            margin-top: -8px; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #cbd5e0;
            border-radius: 4px;
        }
        
        .slider-fill-a::-webkit-slider-runnable-track { background: linear-gradient(to right, #4299e1, #667eea); }
        .slider-fill-b::-webkit-slider-runnable-track { background: linear-gradient(to right, #ed64a6, #9f7aea); }

    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const MagicPotionApp = () => {
            // çŠ¶æ€ç®¡ç†
            const [totalVolume, setTotalVolume] = useState(200); // æ€»é‡ ml
            const [soluteVolume, setSoluteVolume] = useState(50); // åŸæ¶²é‡ ml
            
            // å¸¸é‡
            const MAX_CAPACITY = 500;
            const MIN_CAPACITY = 100;

            // å¤„ç†æ€»é‡å˜åŒ–
            const handleTotalChange = (e) => {
                const newTotal = parseInt(e.target.value);
                setTotalVolume(newTotal);
                // ç‰©ç†çº¦æŸï¼šå¦‚æœæ€»é‡å°äºå½“å‰åŸæ¶²é‡ï¼ŒåŸæ¶²é‡è¢«è¿«å‡å°‘ï¼ˆæº¢å‡ºï¼‰
                if (newTotal < soluteVolume) {
                    setSoluteVolume(newTotal);
                }
            };

            // å¤„ç†åŸæ¶²å˜åŒ–
            const handleSoluteChange = (e) => {
                const newSolute = parseInt(e.target.value);
                // ç‰©ç†çº¦æŸï¼šåŸæ¶²é‡ä¸èƒ½è¶…è¿‡æ€»é‡
                if (newSolute <= totalVolume) {
                    setSoluteVolume(newSolute);
                }
            };

            // è®¡ç®—æµ“åº¦ (0 - 1)
            const concentrationRatio = totalVolume > 0 ? soluteVolume / totalVolume : 0;
            const percentage = (concentrationRatio * 100).toFixed(1);

            // åŠ¨æ€è®¡ç®—é¢œè‰²
            // ä½æµ“åº¦: æµ…è“ (Hue 190, Sat 70%, Light 90%)
            // é«˜æµ“åº¦: æ·±ç´« (Hue 270, Sat 90%, Light 40%)
            const liquidColor = useMemo(() => {
                const h = 190 + (concentrationRatio * 80); // 190 -> 270
                const s = 70 + (concentrationRatio * 20);  // 70% -> 90%
                const l = 90 - (concentrationRatio * 50);  // 90% -> 40%
                return `hsl(${h}, ${s}%, ${l}%)`;
            }, [concentrationRatio]);

            // ç²’å­ç³»ç»Ÿï¼šæµ“åº¦è¶Šé«˜ï¼Œç²’å­è¶Šå¤šï¼Œé€Ÿåº¦è¶Šå¿«
            const particles = useMemo(() => {
                const count = Math.floor(concentrationRatio * 30) + 5; // 5 åˆ° 35 ä¸ªç²’å­
                return Array.from({ length: count }).map((_, i) => ({
                    id: i,
                    left: Math.random() * 100 + '%',
                    delay: Math.random() * 2 + 's',
                    duration: (4 - concentrationRatio * 2) + 's', // æµ“åº¦è¶Šé«˜æµ®åŠ¨è¶Šå¿«
                    size: (Math.random() * 6 + 4) + 'px'
                }));
            }, [concentrationRatio]);

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4">
                    {/* æ ‡é¢˜åŒº */}
                    <header className="text-center mb-6">
                        <h1 className="text-4xl md:text-5xl text-indigo-600 drop-shadow-sm fun-font mb-2">
                            ğŸ§ª é­”æ³•è¯æ°´æµ“åº¦æ¨¡æ‹Ÿå™¨
                        </h1>
                        <p className="text-gray-500 text-lg">
                            æ¥è°ƒé…ä½ çš„ä¸“å±é­”åŠ›è¯æ°´ï¼Œå­¦ä¹ ç™¾åˆ†æ•°å§ï¼
                        </p>
                    </header>

                    <div className="flex flex-col lg:flex-row gap-8 items-center justify-center w-full max-w-5xl">
                        
                        {/* 1. è§†è§‰å±•ç¤ºåŒº (å·¦ä¾§/ä¸Šæ–¹) */}
                        <div className="bg-white p-8 rounded-3xl shadow-xl w-full max-w-sm flex flex-col items-center transform transition-all hover:scale-105 duration-300">
                            <h2 className="fun-font text-2xl text-gray-700 mb-6">è¯æ°´ååº”å †</h2>
                            
                            <div className="beaker-container bg-gray-50">
                                {/* åˆ»åº¦çº¿ */}
                                <div className="measurement-lines">
                                    {[100, 200, 300, 400, 500].map(val => (
                                        <div key={val} style={{bottom: `${(val/MAX_CAPACITY)*100}%`}} className="w-full absolute">
                                            <div className="line"></div>
                                            <div className="line-label fun-font">{val}ml</div>
                                        </div>
                                    ))}
                                </div>

                                {/* æ¶²ä½“ */}
                                <div 
                                    className="liquid"
                                    style={{
                                        height: `${(totalVolume / MAX_CAPACITY) * 100}%`,
                                        backgroundColor: liquidColor,
                                        boxShadow: `0 0 20px ${liquidColor}`
                                    }}
                                >
                                    <div className="wave"></div>
                                    {/* ç²’å­æ•ˆæœ */}
                                    {particles.map(p => (
                                        <div 
                                            key={p.id}
                                            className="particle"
                                            style={{
                                                left: p.left,
                                                width: p.size,
                                                height: p.size,
                                                animationDelay: p.delay,
                                                animationDuration: p.duration
                                            }}
                                        />
                                    ))}
                                </div>
                            </div>
                            
                            <div className="mt-4 text-center">
                                <div className="inline-block px-4 py-2 rounded-full bg-gray-100 text-gray-600 font-bold">
                                    å½“å‰é¢œè‰²æ·±åº¦ï¼š{concentrationRatio > 0.8 ? "ææµ“" : concentrationRatio > 0.5 ? "æµ“éƒ" : concentrationRatio > 0.2 ? "é€‚ä¸­" : "æ¸…æ·¡"}
                                </div>
                            </div>
                        </div>

                        {/* 2. æ•°æ®ä¸æ§åˆ¶åŒº (å³ä¾§/ä¸‹æ–¹) */}
                        <div className="flex flex-col gap-6 w-full max-w-lg">
                            
                            {/* æ§åˆ¶é¢æ¿ */}
                            <div className="bg-white p-6 rounded-3xl shadow-lg border-2 border-indigo-50">
                                <h3 className="fun-font text-xl text-indigo-500 mb-4 flex items-center">
                                    <span className="bg-indigo-100 p-2 rounded-lg mr-2">ğŸ›ï¸</span> 
                                    é…æ–¹æ§åˆ¶
                                </h3>

                                {/* æ»‘å— A: æ€»é‡ */}
                                <div className="mb-6">
                                    <div className="flex justify-between mb-2">
                                        <label className="font-bold text-gray-700">è¯æ°´æ€»é‡ (åˆ†æ¯ B)</label>
                                        <span className="font-mono text-blue-600 bg-blue-50 px-2 rounded">{totalVolume} ml</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min={MIN_CAPACITY} 
                                        max={MAX_CAPACITY} 
                                        step="10"
                                        value={totalVolume}
                                        onChange={handleTotalChange}
                                        className="w-full slider-fill-a"
                                    />
                                </div>

                                {/* æ»‘å— B: åŸæ¶²é‡ */}
                                <div>
                                    <div className="flex justify-between mb-2">
                                        <label className="font-bold text-gray-700">âœ¨ é­”åŠ›åŸæ¶² (åˆ†å­ A)</label>
                                        <span className="font-mono text-purple-600 bg-purple-50 px-2 rounded">{soluteVolume} ml</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min="0" 
                                        max={totalVolume} 
                                        step="5"
                                        value={soluteVolume}
                                        onChange={handleSoluteChange}
                                        className="w-full slider-fill-b"
                                    />
                                    <p className="text-xs text-gray-400 mt-1">* åŸæ¶²é‡ä¸èƒ½è¶…è¿‡æ€»é‡å“¦</p>
                                </div>
                            </div>

                            {/* æ•°å­¦åˆ†æé¢æ¿ */}
                            <div className="bg-yellow-50 p-6 rounded-3xl shadow-inner border-2 border-yellow-200 relative overflow-hidden">
                                <div className="absolute top-0 right-0 p-4 opacity-10 text-6xl">ğŸ“</div>
                                <h3 className="fun-font text-xl text-yellow-700 mb-4 flex items-center relative z-10">
                                    <span className="bg-yellow-200 p-2 rounded-lg mr-2">ğŸ“Š</span> 
                                    æµ“åº¦è®¡ç®—å®éªŒå®¤
                                </h3>

                                <div className="space-y-4 relative z-10">
                                    {/* ç¬¬ä¸€æ­¥ï¼šåˆ†æ•°å½¢å¼ */}
                                    <div className="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                        <div className="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center font-bold text-gray-600 mr-3">1</div>
                                        <div className="flex-1">
                                            <span className="text-gray-500 text-sm block">å†™æˆåˆ†æ•°å½¢å¼ (éƒ¨åˆ† Ã· æ•´ä½“)</span>
                                            <div className="flex items-center font-mono text-lg mt-1">
                                                <div className="flex flex-col items-center mx-2">
                                                    <span className="border-b-2 border-gray-400 px-1 text-purple-600 font-bold">{soluteVolume}</span>
                                                    <span className="text-blue-600 font-bold">{totalVolume}</span>
                                                </div>
                                                <span className="text-gray-400 text-sm ml-2">(åŸæ¶² / æ€»é‡)</span>
                                            </div>
                                        </div>
                                    </div>

                                    {/* ç¬¬äºŒæ­¥ï¼šè®¡ç®—è¿‡ç¨‹ */}
                                    <div className="flex items-center bg-white p-3 rounded-xl shadow-sm">
                                        <div className="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center font-bold text-gray-600 mr-3">2</div>
                                        <div className="flex-1">
                                            <span className="text-gray-500 text-sm block">è½¬åŒ–ä¸ºå°æ•°å¹¶ä¹˜ä»¥ 100</span>
                                            <div className="font-mono text-lg mt-1 text-gray-700">
                                                ( {soluteVolume} Ã· {totalVolume} ) Ã— 100
                                            </div>
                                            <div className="text-sm text-gray-400 mt-1">
                                                â‰ˆ {concentrationRatio.toFixed(3)} Ã— 100
                                            </div>
                                        </div>
                                    </div>

                                    {/* ç¬¬ä¸‰æ­¥ï¼šç»“æœ */}
                                    <div className="bg-gradient-to-r from-purple-500 to-indigo-600 p-4 rounded-xl text-white shadow-md flex justify-between items-center">
                                        <div>
                                            <span className="block text-purple-100 text-sm mb-1">æœ€ç»ˆæµ“åº¦ (ç™¾åˆ†æ•°)</span>
                                            <span className="text-4xl font-bold fun-font tracking-wider">
                                                {percentage}<span className="text-2xl">%</span>
                                            </span>
                                        </div>
                                        <div className="text-4xl animate-pulse">
                                            {percentage > 50 ? 'ğŸ”¥' : 'âœ¨'}
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MagicPotionApp />);
    </script>
</body>
</html>
